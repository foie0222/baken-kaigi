# 馬券会議 - ユーザーストーリー作成計画

## 概要
本計画は、責任あるギャンブルを促進する競馬ベッター向けAIコーチングアプリ「馬券会議」のユーザーストーリーを作成するためのステップを定義します。

---

## 確定した要件サマリー

### ユーザーペルソナ優先順位
1. **依存症傾向のあるユーザー**（自己管理を求めている方）← 最優先
2. 一般的な競馬ファン（娯楽目的のベッター）
3. 競馬初心者（これから始める方）
4. ~~家族メンバー~~ → スコープ外

### MVP機能優先順位
1. **AI対話**（賭けについての会話・フィードバック）
2. **中毒防止機能**（負け額限度額、アラート、損益ダッシュボード）
3. **JRA IPAT購入統合**
4. ~~ファミリー共有モード~~ → スコープ外

### 非機能要件
- セキュリティファーストで堅牢なシステム
- 法的要件（年齢確認、ギャンブル関連法規）は必須

### AI対話機能の詳細
- レース情報はシステム上に表示
- ユーザーは買い目を入力（即PATと同様のUI）
- AIは過去の成績、騎手情報、馬場状態、オッズなど利用可能な全情報を使用
- 会話履歴は1週間保存

### 中毒防止機能の詳細
- **負け額限度額**: ユーザーが設定、到達したらその月は賭け不可（絶対）
- **アラート**: 負け額限度額に到達する見込み時に画面上部に大きく表示
- **クールダウン**: 負け額限度額到達で強制待機
- **損益ダッシュボード**: 表示期間無制限、日次/週次/月次/累計グラフ表示

### JRA IPAT購入統合の詳細
- JRA IPAT APIを使用
- 購入結果（当たり/外れ、払戻金）は自動取得
- 認証情報はセキュアに保存

---

## 作成計画

### Phase 1: 要件の明確化

- [x] **ステップ 1: ユーザーペルソナの定義**
  - ターゲットユーザーの種類と特性を明確化
  - 各ペルソナの目標、課題、ニーズを整理
  - 対象ペルソナ: 依存症傾向のあるユーザー、一般競馬ファン、競馬初心者

- [x] **ステップ 2: MVPスコープの確定**
  - 初期リリースに含める機能の範囲を文書化
  - スコープ: AI対話、中毒防止機能、JRA IPAT購入統合、ユーザー管理
  - スコープ外: ファミリー共有モード

- [x] **ステップ 3: 非機能要件の文書化**
  - セキュリティ要件（セキュリティファースト）
  - 法的要件（年齢確認、ギャンブル関連法規）
  - パフォーマンス・アクセシビリティ要件

---

### Phase 2: エピックとユーザーストーリーの作成

- [x] **ステップ 4: エピックの定義**
  - コア機能ごとにエピック（大きな機能単位）を定義
  - 各エピックの目的と範囲を明確化

- [x] **ステップ 5: ユーザーストーリーの作成 - AI対話機能**
  - AI対話機能に関するユーザーストーリーを作成
  - 「〜として、〜したい、なぜなら〜」形式で記述
  - レース情報表示、買い目入力（チェックボックス選択）、カート機能、AIフィードバック（即時表示）、会話履歴
  - **モック実装に基づく更新済み**: カート機能追加、チェックボックス選択UI、即時フィードバック表示

- [x] **ステップ 6: ユーザーストーリーの作成 - 中毒防止機能**
  - 負け額限度額設定、アラート、強制待機、損益ダッシュボードに関するストーリーを作成

- [x] **ステップ 7: ユーザーストーリーの作成 - JRA IPAT購入統合**
  - JRA IPAT API連携、認証、購入、結果取得に関するストーリーを作成

- [x] **ステップ 8: ユーザーストーリーの作成 - ユーザー管理・認証**
  - アカウント登録、ログイン、プロフィール管理、年齢確認に関するストーリーを作成
  - 10件のストーリーを作成（US-04-001〜010）

---

### Phase 3: 受け入れ条件と優先順位付け

- [x] **ステップ 9: 受け入れ条件の定義**
  - 各ユーザーストーリーに対して、具体的な受け入れ条件を定義
  - テスト可能な条件を記述
  - **全36件のユーザーストーリーに受け入れ条件を追加済み**

- [x] **ステップ 10: 優先順位付け（MoSCoW法）**
  - Must have（必須）: 16件
  - Should have（重要）: 11件
  - Could have（あれば良い）: 9件
  - Won't have（今回は対象外）: 0件（既にスコープ外として除外済み）
  - **実装推奨順序（5フェーズ）も定義済み**

- [x] **ステップ 11: 最終レビューとドキュメント整理**
  - 全ユーザーストーリーの整合性確認
  - ドキュメントの最終整理
  - **完了: 2026-01-19**

---

## 最終レビュー結果

### 整合性確認

| チェック項目 | 結果 | 備考 |
|-------------|------|------|
| ユーザーストーリー数 | ✅ | 36件（EPIC-01:11, EPIC-02:8, EPIC-03:7, EPIC-04:10） |
| 受け入れ条件 | ✅ | 全36件に定義済み |
| MoSCoW分類 | ✅ | Must:16, Should:11, Could:9, Won't:0 |
| ペルソナとの整合性 | ✅ | 全ペルソナのニーズをカバー |
| MVPスコープとの整合性 | ✅ | スコープ内機能を全てストーリー化 |
| エピックとの整合性 | ✅ | 4エピック全てにストーリーを割当 |
| 非機能要件の考慮 | ✅ | セキュリティ・法的要件をストーリーに反映 |

### ドキュメント一覧

| ファイル名 | 内容 | 行数 |
|-----------|------|------|
| user_personas.md | ユーザーペルソナ定義 | 177行 |
| mvp_scope.md | MVPスコープ定義 | 162行 |
| epics.md | エピック一覧 | 195行 |
| non_functional_requirements.md | 非機能要件 | 164行 |
| user_stories.md | ユーザーストーリー一覧 | 1200行以上 |
| user_stories_plan.md | 本計画書 | 本ファイル |

---

## 成果物
- `aidlc-docs/inception/user_personas.md` - ユーザーペルソナ定義書
- `aidlc-docs/inception/epics.md` - エピック一覧
- `aidlc-docs/inception/user_stories.md` - ユーザーストーリー一覧（受け入れ条件含む）

---

## 備考
- 本計画は承認後に実行を開始します
- 各ステップ完了後にレビューを実施します
