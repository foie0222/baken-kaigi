# 馬券会議 - エピック一覧

## 概要
本ドキュメントは、「馬券会議」アプリのエピック（大きな機能単位）を定義します。
各エピックは複数のユーザーストーリーで構成されます。

---

## エピック一覧

| エピックID | エピック名 | 優先度 | 対象ペルソナ |
|-----------|-----------|--------|-------------|
| EPIC-01 | AI対話機能 | 最高 | 全ペルソナ |
| EPIC-02 | 中毒防止機能 | 最高 | 全ペルソナ（特にペルソナ1） |
| EPIC-03 | JRA IPAT購入統合 | 高 | 全ペルソナ |
| EPIC-04 | ユーザー管理・認証 | 高 | 全ペルソナ |

---

## EPIC-01: AI対話機能

### 目的
AIの力でユーザーが勝てる賭けを見つけ、無謀な賭けを避けることを支援する。

### ビジネス価値
- プロダクトの核心的な差別化要因
- AIによる予測・推奨で回収率向上を支援
- 無謀な賭けの抑制で依存症を予防

### 範囲
| 機能 | 説明 |
|------|------|
| レース情報表示 | 当日のレース一覧、出走馬、オッズ等を表示 |
| 買い目入力 | チェックボックスで馬番を選択、券種に応じた必要数を表示 |
| カート機能 | 複数の買い目をカートに追加し、まとめて管理 |
| AI相談・データフィードバック | 買い目に対する即時フィードバック（馬の分析、オッズ、掛け金情報） |
| 掛け金フィードバック | 掛け金額に対する客観的なFB（残り許容負け額、過去平均との比較等） |
| 会話履歴保存 | 過去1週間の会話履歴を保存・閲覧可能 |
| **勝敗予測・推奨** | AIによる勝ち馬予測と期待値の高い買い目の推奨 |
| **期待値計算** | オッズと過去データから期待値を算出・表示 |

### 含まれないこと
- 「絶対当たる」等の過度な煽り表現
- 負けを取り戻させる誘導

### 依存関係
- 基本機能（レース情報表示、買い目入力、AIフィードバック）は認証不要
- 会話履歴の保存はEPIC-04（ユーザー管理・認証）が必要

### 認証要否

| 機能 | 認証 |
|------|------|
| レース情報表示 | 不要 |
| 買い目入力（チェックボックス選択） | 不要 |
| カート機能 | 不要 |
| AI相談・データフィードバック | 不要 |
| 掛け金フィードバック | 不要 |
| 会話履歴保存 | **必要** |

### 想定ユーザーストーリー数
12〜14件

---

## EPIC-02: 中毒防止機能

### 目的
ユーザーが自己設定した負け額限度額内で賭けを行い、依存症を予防する。

### ビジネス価値
- 社会意義指標の中核（負け額限度額遵守率100%）
- ユーザーの信頼獲得
- 責任あるギャンブルプラットフォームとしてのブランド確立

### 範囲
| 機能 | 説明 |
|------|------|
| 負け額限度額設定 | ユーザーが月間の負け額上限を自己設定 |
| 強制停止機能 | 負け額限度額到達時、その月は賭け不可（回避不可能） |
| 限度額接近アラート | 負け額限度額に到達する見込み時、画面上部に大きく警告表示 |
| 損益ダッシュボード | 日次/週次/月次/累計の損益をグラフで可視化 |
| 賭け履歴一覧 | 過去の全賭け履歴を期間無制限で閲覧可能 |

### 設計原則
- **負け額限度額の強制停止は絶対に回避できない設計**
- 限度額の増額には待機期間を設ける（衝動的な変更防止）

### 依存関係
- EPIC-04（ユーザー管理・認証）が前提
- EPIC-03（JRA IPAT購入統合）から購入結果データを取得

### 想定ユーザーストーリー数
6〜8件

---

## EPIC-03: JRA IPAT購入統合

### 目的
AIとの対話後、シームレスにJRA IPAT経由で馬券を購入できる体験を提供する。

### ビジネス価値
- ユーザー体験の向上（アプリ完結型）
- 購入データの自動取得による正確な損益管理
- AI対話と購入のシームレスな連携

### 範囲
| 機能 | 説明 |
|------|------|
| IPAT認証連携 | JRA IPATの認証情報をセキュアに保存・管理 |
| 馬券購入機能 | AIとの会話後、シームレスにIPAT経由で馬券購入 |
| 購入結果自動取得 | 購入結果（当たり/外れ、払戻金）を自動取得 |
| 残高表示 | IPAT口座残高の表示 |

### セキュリティ要件
- IPAT認証情報は暗号化して保存
- 認証情報へのアクセスは本人確認後のみ

### 依存関係
- EPIC-04（ユーザー管理・認証）が前提
- JRA IPAT APIの仕様確認が必要

### 想定ユーザーストーリー数
5〜7件

---

## EPIC-04: ユーザー管理・認証

### 目的
セキュアなユーザー認証と、法的要件（年齢確認等）を満たすアカウント管理を提供する。

### ビジネス価値
- セキュリティの基盤
- 法的要件の遵守
- ユーザーデータの適切な管理

### 範囲
| 機能 | 説明 |
|------|------|
| アカウント登録 | メールアドレスまたはSNS認証による新規登録 |
| ログイン/ログアウト | セキュアな認証機能 |
| 年齢確認 | 20歳以上であることの確認（法的要件） |
| プロフィール管理 | 基本情報の編集 |
| パスワードリセット | メールによるパスワード再設定 |

### 法的要件
- 20歳以上の年齢確認必須
- 利用規約・プライバシーポリシーへの同意必須

### 依存関係
- なし（他のエピックの前提条件）

### 想定ユーザーストーリー数
5〜7件

---

## エピック依存関係図

```
EPIC-01: AI対話機能（基本機能は認証不要）
    │
    └──→ 会話履歴保存 ──→ EPIC-04: ユーザー管理・認証
                              │
                              ├──→ EPIC-02: 中毒防止機能 ←── EPIC-03からデータ取得
                              │
                              └──→ EPIC-03: JRA IPAT購入統合
```

---

## 実装順序（推奨）

| 順序 | エピック | 理由 |
|-----|---------|------|
| 1 | EPIC-01: AI対話機能（基本） | 認証不要でプロダクトの核心機能を先行リリース可能 |
| 2 | EPIC-04: ユーザー管理・認証 | 会話履歴保存、購入、中毒防止に必要 |
| 3 | EPIC-03: JRA IPAT購入統合 | 購入データが中毒防止機能に必要 |
| 4 | EPIC-02: 中毒防止機能 | 購入結果データを活用 |
| 5 | EPIC-01: AI対話機能（会話履歴） | 認証後の追加機能 |

※ 認証不要のAI対話機能を先行リリースし、ユーザー獲得後に認証機能を追加する戦略

---

## エピックとユーザーストーリーの関係

| エピック | 想定ストーリー数 | 次ステップ |
|---------|-----------------|-----------|
| EPIC-01 | 6〜8件 | ステップ5で詳細化 |
| EPIC-02 | 6〜8件 | ステップ6で詳細化 |
| EPIC-03 | 5〜7件 | ステップ7で詳細化 |
| EPIC-04 | 5〜7件 | ステップ8で詳細化 |
| **合計** | **22〜30件** | - |
